![](https://img.shields.io/badge/-C++-00599C?&logo=c++&logoColor=FFFFFF) ![](https://img.shields.io/badge/-C-A8B9CC&logo=c&logoColor=FFFFFF) ![](https://img.shields.io/badge/-ONNX-005CED&logo=onnx&logoColor=FFFFFF) ![](https://img.shields.io/badge/-OpenCV-5C3EE8?logo=opencv&logoColor=FFFFFF) ![](https://img.shields.io/badge/CMake-5DE34F) ![](https://img.shields.io/badge/SPDLOG-FF233F) ![](https://img.shields.io/badge/ONNXRuntime-FABEF09)  
![](https://img.shields.io/badge/Charles_shu-life_is_a_very_very_long_learning_process-1ABF223)

#### GeneralDeepLearing_Infer
æœ¬ä»“åº“æ˜¯ä¸€ä¸ªåŸºäºC++å®ç°çš„æ·±åº¦å­¦ä¹ æ¨ç†åº“ï¼Œç°æ”¯æŒä¸Šè¿°å¸¸è§å¤§éƒ¨åˆ†Onnxæ¨¡å‹æ¨ç†ï¼Œåç»­å°†ç»§ç»­å¢åŠ æ›´å¤šå¸¸è§æ¨¡å‹çš„æ¨ç†è¿‡ç¨‹,åŒ…æ‹¬å¯¹åº”çš„TensorRTå’ŒLibTorchçš„å®ç°å°†åœ¨ä¸‹ä¸€æ¬¡æ›´æ–°è®¡åˆ’ä¸­

![](https://img.shields.io/badge/YOLOV8-Detection-green) ![](https://img.shields.io/badge/YOLOV8-Segmentation-red) ![](https://img.shields.io/badge/YOLOV8-POSE-005DEF) 
![](https://img.shields.io/badge/YOLOV7-Detection-FFFF) ![](https://img.shields.io/badge/YOLOV7-Segmentation-A11B23) ![](https://img.shields.io/badge/YOLOV5-Detection-FFFF) ![](https://img.shields.io/badge/YOLOV5-Segmentation-F1111F) ![](https://img.shields.io/badge/UNet-1ABF223)

ğŸš€ğŸš€ğŸš€ç›®å‰å¤§éƒ¨åˆ†å¼€æºåº“å®ç°äº†å¯¹ä¸€äº›å¸¸è§æ¨¡å‹çš„æ¨ç†ä»£ç ï¼Œç„¶è€Œå¤§éƒ¨åˆ†éƒ½æ˜¯ä»…ä»…å®ç°äº†OnnxRuntimeæˆ–è€…TensorRTå•ä¸ªæ¨ç†åº“çš„æ¨ç†ä»£ç ä¸”éƒ¨åˆ†ä»£ç åªæ˜¯ä¸€ä¸ªdemoï¼Œæ²¡æœ‰è¿›è¡Œé€‚å½“çš„ä»£ç å°è£…ï¼Œä¸åˆ©äºå¿«é€Ÿåœ°å·¥ç¨‹å¼€å‘å’Œè½åœ°åº”ç”¨ï¼Œè¿™æ˜¯æœ¬äººå»ºç«‹æœ¬ä»“åº“çš„åˆè¡·ï¼Œä»“åº“çš„åç§°ä¸ºGeneralDeepLearning_Inferï¼Œèµ·åˆçš„æƒ³æ³•æ˜¯æƒ³æ„å»ºä¸€ä¸ªå¯¹äºå¤§å¤šæ•°æ¨¡å‹"General"é€šç”¨çš„æ¨ç†åº“ï¼Œä½†æ˜¯å°±ç°é˜¶æ®µçš„ä»£ç è€Œè¨€è¿˜è¿œè¿œæ²¡æœ‰è¾¾åˆ°é€šç”¨"General"ä¸€è¯ã€‚è®¡ç®—æœºè§†è§‰æ¨¡å‹çš„è¾“å…¥æ•°æ®ä¸å•å•æ˜¯ç°åº¦å›¾åƒã€å½©è‰²å›¾åƒã€æœ‰åºç‚¹äº‘å›¾åƒ(3Dç›¸æœº)ï¼ŒåŒæ—¶è¿˜åŒ…æ‹¬æ¿€å…‰é›·è¾¾æ— åºç‚¹äº‘æ•°æ®ã€æ¯«ç±³æ³¢é›·è¾¾æ•°æ®ç­‰ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯è¿™äº›æ•°æ®çš„å¤šç§ç»„åˆã€‚å¦‚ä½•çœŸæ­£åšåˆ°Generalè¿˜éœ€è¦è¿›ä¸€æ­¥æ€è€ƒã€‚

è¨€å½’æ­£ä¼ ï¼Œä¸‹é¢ç®€è¦ä»‹ç»è¯¥åº“æ–‡ä»¶ç»„ç»‡ç»“æ„

GeneralDeepLearing_Infer/  
â”‚  
â”œâ”€â”€ Demo/            // æµ‹è¯•ä»£ç æ–‡ä»¶å¤¹  
â”‚   â”œâ”€â”€ Header/      // æµ‹è¯•ä»£ç å¤´æ–‡ä»¶æ–‡ä»¶å¤¹  
â”‚   â””â”€â”€ Impl/        // æµ‹è¯•ä»£ç å®ç°æ–‡ä»¶æ–‡ä»¶å¤¹  
â”‚  
â”œâ”€â”€ Example/         // æµ‹è¯•æ¨¡å‹å’Œæ•°æ®æ–‡ä»¶å¤¹  
â”‚   â”œâ”€â”€ Onnx/        // onnxæ¨¡å‹æ–‡ä»¶å¤¹  
â”‚   â”œâ”€â”€ TensorRT/    // tensorrtæ¨¡å‹æ–‡ä»¶å¤¹  
â”‚   â””â”€â”€ TorchScript/ // TorchScript  
|  
â”œâ”€â”€ Modules/                        // å„ç§æ¨ç†åº“æ–‡ä»¶å¤¹  
â”‚   â”œâ”€â”€ GeneralLibTorch_Infer/      // LibTorchæ¨ç†åº“ å¾…å¼€å‘  
â”‚   â”œâ”€â”€ GeneralOnnxRuntime_Infer/   // OnnxRuntimeæ¨ç†åº“
â”‚   â””â”€â”€ GeneralTensorRT_Infer/      // TensorRTæ¨ç†åº“ å¾…å¼€å‘  
|  
â”œâ”€â”€ Release/                        // ç¼–è¯‘è¾“å‡ºæ–‡ä»¶å¤¹  
â”‚   â”œâ”€â”€ bin/                        // å¯æ‰§è¡Œæ–‡ä»¶è¾“å‡ºæ–‡ä»¶å¤¹  
â”‚   â””â”€â”€ lib/                        // åº“æ–‡ä»¶è¾“å‡ºæ–‡ä»¶å¤¹  
â”‚  
â””â”€â”€ ThirdParty/                     // ç¬¬ä¸‰æ–¹åº“æ–‡ä»¶å¤¹  
    â”œâ”€â”€ onnxruntime/                // onnxruntimeåº“  
    â”œâ”€â”€ opencv/                     // opencvåº“  
    â””â”€â”€ spodlog/                    // spdlogåº“

æ¨èä½¿ç”¨windowsä¸­Cmake-Guiæ„å»ºå·¥ç¨‹ï¼Œä½¿ç”¨Visual Studio 2019æ‰“å¼€å·¥ç¨‹ç¼–è¯‘å³å¯,è¯¦ç»†æ­¥éª¤å¦‚ä¸‹  

1ã€é¦–å…ˆä¸‹è½½ä»“åº“ä»£ç 
```donwnload
git clone https://github.com/CharlesShu/GeneralDeepLearning_Infer.git
```
2ã€è§£å‹è¯¥æ–‡ä»¶åŒ…ï¼Œåœ¨æ–‡ä»¶åŒ…å†…æ–°å»ºbuildæ–‡ä»¶å¤¹ï¼Œ æ‰“å¼€Cmake-Guiï¼Œé€‰æ‹©source code æ–‡ä»¶å¤¹é€‰æ‹©GeneralDeepLearning_Inferæ–‡ä»¶å¤¹ï¼Œbuild binaryæ–‡ä»¶å¤¹é€‰æ‹©buildæ–‡ä»¶å¤¹ï¼Œç‚¹å‡»Configureï¼Œé€‰æ‹©Visual Studio 2019ï¼Œ x64ï¼Œ ç‚¹å‡»Finishï¼Œç‚¹å‡»Generateï¼Œç‚¹å‡»Open Projectï¼Œæ‰“å¼€Visual Studio 2019ï¼Œç¼–è¯‘å³å¯

3ã€ç¼–è¯‘ä¸­ç‚¹å‡»ALL_BUILD,å³é”®é€‰æ‹©é‡æ–°ç”Ÿæˆï¼Œç¼–è¯‘åçš„dllå’Œæµ‹è¯•exeå­˜æ”¾åœ¨Release/binç›®å½•ä¸­ï¼ŒåŠ¨æ€åº“å¯¹åº”çš„libæ–‡ä»¶å­˜æ”¾åœ¨Release/libä¸­ã€‚æ¨èä½¿ç”¨ALL_BUILDç¼–è¯‘ï¼Œä¸€æ¬¡æ€§ç¼–è¯‘æ‰€æœ‰å·¥ç¨‹ï¼Œå¦‚æœè‡ªå·±æƒ³æ‰‹åŠ¨ç¼–è¯‘çš„è¯ï¼ŒDemoå·¥ç¨‹è¦ä¾èµ–äºGeneralOnnxRuntime_Inferï¼Œæ‰‹åŠ¨ç¼–è¯‘å…ˆç¼–è¯‘åè€…ï¼Œç„¶åç¼–è¯‘å‰è€…

4ã€å•å‡»Demoå·¥ç¨‹ï¼Œå³é”®è®¾ç½®ä¸ºå¯åŠ¨é¡¹ï¼Œæ‰“å¼€Demo.cppæºæ–‡ä»¶ï¼Œåœ¨mainå‡½æ•°ä¸­ï¼Œä¿®æ”¹å¦‚ä¸‹ï¼š

```
//ä¿®æ”¹å›¾ç‰‡è·¯å¾„ï¼Œæ³¨æ„R"()"ä¸­ç›´æ¥åŠ åŸå§‹è·¯å¾„å°±å¯ä»¥ï¼Œä¸ç”¨å†åŠ å¼•å·å’ŒåŒæ–œæ ï¼Œå­—ç¬¦ä¸ä¼šè¢«è½¬ä¹‰
cv::Mat curr_image = cv::imread(R"(F:\CV_Treasure\GeneralOnnxRuntime_Infer\data\car.jpg)");
cv::Mat next_image = cv::imread(R"(F:\YOLO\infer-main\workspace\inference\gril.jpg)");
```
```
//ä¿®æ”¹æ¨¡å‹è·¯å¾„ Demo.cpp 19 lines
modelParam.OnnxModelPath =
R"(F:\CV_Treasure\GeneralOnnxRuntime_Infer\data\yolov8n-pose.onnx)";
//ä¿®æ”¹æ¨¡å‹ä»»åŠ¡ç±»å‹å’Œæ¨¡å‹ç±»å‹ Demo.cpp 26 27 lines
modelTypeParams.TaskType = TASK_POSE_ESTIMATION;   // å‚è€ƒStructNameDefines.hä¸­å®šä¹‰
modelTypeParams.ModelType = YOLO_V8;               // å‚è€ƒStructNameDefines.hä¸­å®šä¹‰
```
```
// ä¿®æ”¹æ—¥å¿—ä¿å­˜è·¯å¾„ æ£€æµ‹ç»“æœä¹Ÿå°†å­˜æ”¾äºè¯¥æ–‡ä»¶å¤¹ä¸‹  Demo.cpp 32 33 lines
logParams.LogPath = "F:\\CV_Treasure\\GeneralOnnxRuntime_Infer\\log";
```
```
// ä¿®æ”¹åŸºç±»æŒ‡é’ˆæŒ‡å‘çš„æ´¾ç”Ÿç±»å¯¹è±¡, æ ¹æ®ç½‘ç»œé€‰æ‹©åˆé€‚çš„æ´¾ç”Ÿç±»å¯¹è±¡ Demo.cpp 61 lines
 std::unique_ptr<GeneralOnnxBase> netobj = std::make_unique<GeneralOnnxYOLO>(); //YOLO
 or netobj = std::make_unique<GeneralOnnxUNet>() //UNet
```
5ã€å®Œæˆä¸Šè¿°ä¿®æ”¹åï¼Œç‚¹å‡»è¿è¡Œå³å¯ã€‚

ğŸ”¥ğŸ”¥ğŸ”¥æ³¨æ„å½“å‰ç‰ˆæœ¬ä»£ç ä»…æ”¯æŒwindowsä½¿ç”¨ï¼Œæ”¯æŒå¤šbatchæ¨ç†ï¼Œä¸æ”¯æŒåŠ¨æ€é«˜å®½(ä¸ªäººè§‰å¾—æ²¡å•¥ç”¨)ï¼Œæš‚æ—¶ä¸æ”¯æŒå¼‚æ­¥å¤šçº¿ç¨‹è°ƒç”¨

ğŸš¨ğŸš¨ğŸš¨ æœ¬ä»“åº“ä¸­åŒ…å«çš„onnxruntimeåº“ç‰ˆæœ¬ä¸º1.17ï¼Œè¯·æ£€æŸ¥ç”µè„‘çš„cudaç‰ˆæœ¬æ˜¯å¦æ”¯æŒè¯¥ç‰ˆæœ¬onnxruntimeåº“ï¼Œå¦‚æœcudaç‰ˆæœ¬è¾ƒä½ä¸æ”¯æŒè¯¥onnxruntimeåº“ï¼Œéœ€è¦è‡ªè¡Œä¸‹è½½é€‚é…çš„onnxruntimeç‰ˆæœ¬https://github.com/microsoft/onnxruntime/releases, æŒ‰ç…§åŸæ–‡ä»¶å¤¹åå­—å’Œæ–‡ä»¶ç»„ç»‡ç»“æ„æ›¿æ¢å³å¯ï¼ŒåŒæ—¶éœ€è¦å°†onnxtuntime.dllå¤åˆ¶åˆ°libæ–‡ä»¶å¤¹ä¸­çš„å››ä¸ª.dllå¤åˆ¶åˆ°Relese\binç›®å½•ä¸‹ï¼Œopencvå’Œspdlogä¸ä¼šå­˜åœ¨å…¼å®¹æ€§é—®é¢˜

ğŸ™ˆğŸ™ˆğŸ™ˆ æœ€åå¸Œæœ›å„ä½å¤§ä½¬ç‚¹ä¸ªèµ
#### å¼•ç”¨
[1] https://github.com/Shiftqueue/onnxruntime_use_cpp  
[2] https://github.com/UNeedCryDear/yolov8-opencv-onnxruntime-cpp  
[3] https://github.com/ultralytics/ultralytics  
[4] https://github.com/microsoft/onnxruntime
